---
import Layout from '../layouts/Layout.astro';
import { contentfulClient } from '../lib/contentful';

// Get all content types to see their actual IDs
let contentTypes = [];
let error = null;

try {
  const response = await contentfulClient.getContentTypes();
  contentTypes = response.items.map(ct => ({
    id: ct.sys.id,
    name: ct.name,
    displayField: ct.displayField,
    fields: ct.fields.map(f => f.id).join(', ')
  }));
} catch (e) {
  error = e.message;
}
---

<Layout title="Content Types Check">
  <main class="container my-5">
    <h1>Contentful Content Types</h1>
    
    {error ? (
      <div class="alert alert-danger">
        Error: {error}
      </div>
    ) : (
      <div>
        <p>Found {contentTypes.length} content types:</p>
        
        <table class="table">
          <thead>
            <tr>
              <th>Content Type ID</th>
              <th>Name</th>
              <th>Display Field</th>
              <th>Fields</th>
            </tr>
          </thead>
          <tbody>
            {contentTypes.map((ct) => (
              <tr>
                <td><code>{ct.id}</code></td>
                <td>{ct.name}</td>
                <td>{ct.displayField}</td>
                <td><small>{ct.fields}</small></td>
              </tr>
            ))}
          </tbody>
        </table>
        
        <div class="alert alert-info mt-4">
          <p><strong>Important:</strong> The Content Type ID (first column) is what you need to use in API queries, not the Name.</p>
        </div>
      </div>
    )}
  </main>
</Layout>

<style>
  code {
    background-color: #f0f0f0;
    padding: 2px 6px;
    border-radius: 3px;
    color: #d73a49;
    font-weight: bold;
  }
  
  table {
    width: 100%;
    margin-top: 1rem;
  }
  
  th {
    background-color: #f8f9fa;
  }
</style>